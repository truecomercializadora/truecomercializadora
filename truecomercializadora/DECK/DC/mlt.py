from truecomercializadora.DECK.utils import UTILS
from datetime import datetime

class mlt_block(UTILS):
    def __init__(self):
        self.cabecalho = ""
        self.size = 1280
        self.campos = [(1, 4, 'I4', 'Usina 1'),
    (5, 8, 'I4', 'Usina 2'),
    (9, 12, 'I4', 'Usina 3'),
    (13, 16, 'I4', 'Usina 4'),
    (17, 20, 'I4', 'Usina 5'),
    (21, 24, 'I4', 'Usina 6'),
    (25, 28, 'I4', 'Usina 7'),
    (29, 32, 'I4', 'Usina 8'),
    (33, 36, 'I4', 'Usina 9'),
    (37, 40, 'I4', 'Usina 10'),
    (41, 44, 'I4', 'Usina 11'),
    (45, 48, 'I4', 'Usina 12'),
    (49, 52, 'I4', 'Usina 13'),
    (53, 56, 'I4', 'Usina 14'),
    (57, 60, 'I4', 'Usina 15'),
    (61, 64, 'I4', 'Usina 16'),
    (65, 68, 'I4', 'Usina 17'),
    (69, 72, 'I4', 'Usina 18'),
    (73, 76, 'I4', 'Usina 19'),
    (77, 80, 'I4', 'Usina 20'),
    (81, 84, 'I4', 'Usina 21'),
    (85, 88, 'I4', 'Usina 22'),
    (89, 92, 'I4', 'Usina 23'),
    (93, 96, 'I4', 'Usina 24'),
    (97, 100, 'I4', 'Usina 25'),
    (101, 104, 'I4', 'Usina 26'),
    (105, 108, 'I4', 'Usina 27'),
    (109, 112, 'I4', 'Usina 28'),
    (113, 116, 'I4', 'Usina 29'),
    (117, 120, 'I4', 'Usina 30'),
    (121, 124, 'I4', 'Usina 31'),
    (125, 128, 'I4', 'Usina 32'),
    (129, 132, 'I4', 'Usina 33'),
    (133, 136, 'I4', 'Usina 34'),
    (137, 140, 'I4', 'Usina 35'),
    (141, 144, 'I4', 'Usina 36'),
    (145, 148, 'I4', 'Usina 37'),
    (149, 152, 'I4', 'Usina 38'),
    (153, 156, 'I4', 'Usina 39'),
    (157, 160, 'I4', 'Usina 40'),
    (161, 164, 'I4', 'Usina 41'),
    (165, 168, 'I4', 'Usina 42'),
    (169, 172, 'I4', 'Usina 43'),
    (173, 176, 'I4', 'Usina 44'),
    (177, 180, 'I4', 'Usina 45'),
    (181, 184, 'I4', 'Usina 46'),
    (185, 188, 'I4', 'Usina 47'),
    (189, 192, 'I4', 'Usina 48'),
    (193, 196, 'I4', 'Usina 49'),
    (197, 200, 'I4', 'Usina 50'),
    (201, 204, 'I4', 'Usina 51'),
    (205, 208, 'I4', 'Usina 52'),
    (209, 212, 'I4', 'Usina 53'),
    (213, 216, 'I4', 'Usina 54'),
    (217, 220, 'I4', 'Usina 55'),
    (221, 224, 'I4', 'Usina 56'),
    (225, 228, 'I4', 'Usina 57'),
    (229, 232, 'I4', 'Usina 58'),
    (233, 236, 'I4', 'Usina 59'),
    (237, 240, 'I4', 'Usina 60'),
    (241, 244, 'I4', 'Usina 61'),
    (245, 248, 'I4', 'Usina 62'),
    (249, 252, 'I4', 'Usina 63'),
    (253, 256, 'I4', 'Usina 64'),
    (257, 260, 'I4', 'Usina 65'),
    (261, 264, 'I4', 'Usina 66'),
    (265, 268, 'I4', 'Usina 67'),
    (269, 272, 'I4', 'Usina 68'),
    (273, 276, 'I4', 'Usina 69'),
    (277, 280, 'I4', 'Usina 70'),
    (281, 284, 'I4', 'Usina 71'),
    (285, 288, 'I4', 'Usina 72'),
    (289, 292, 'I4', 'Usina 73'),
    (293, 296, 'I4', 'Usina 74'),
    (297, 300, 'I4', 'Usina 75'),
    (301, 304, 'I4', 'Usina 76'),
    (305, 308, 'I4', 'Usina 77'),
    (309, 312, 'I4', 'Usina 78'),
    (313, 316, 'I4', 'Usina 79'),
    (317, 320, 'I4', 'Usina 80'),
    (321, 324, 'I4', 'Usina 81'),
    (325, 328, 'I4', 'Usina 82'),
    (329, 332, 'I4', 'Usina 83'),
    (333, 336, 'I4', 'Usina 84'),
    (337, 340, 'I4', 'Usina 85'),
    (341, 344, 'I4', 'Usina 86'),
    (345, 348, 'I4', 'Usina 87'),
    (349, 352, 'I4', 'Usina 88'),
    (353, 356, 'I4', 'Usina 89'),
    (357, 360, 'I4', 'Usina 90'),
    (361, 364, 'I4', 'Usina 91'),
    (365, 368, 'I4', 'Usina 92'),
    (369, 372, 'I4', 'Usina 93'),
    (373, 376, 'I4', 'Usina 94'),
    (377, 380, 'I4', 'Usina 95'),
    (381, 384, 'I4', 'Usina 96'),
    (385, 388, 'I4', 'Usina 97'),
    (389, 392, 'I4', 'Usina 98'),
    (393, 396, 'I4', 'Usina 99'),
    (397, 400, 'I4', 'Usina 100'),
    (401, 404, 'I4', 'Usina 101'),
    (405, 408, 'I4', 'Usina 102'),
    (409, 412, 'I4', 'Usina 103'),
    (413, 416, 'I4', 'Usina 104'),
    (417, 420, 'I4', 'Usina 105'),
    (421, 424, 'I4', 'Usina 106'),
    (425, 428, 'I4', 'Usina 107'),
    (429, 432, 'I4', 'Usina 108'),
    (433, 436, 'I4', 'Usina 109'),
    (437, 440, 'I4', 'Usina 110'),
    (441, 444, 'I4', 'Usina 111'),
    (445, 448, 'I4', 'Usina 112'),
    (449, 452, 'I4', 'Usina 113'),
    (453, 456, 'I4', 'Usina 114'),
    (457, 460, 'I4', 'Usina 115'),
    (461, 464, 'I4', 'Usina 116'),
    (465, 468, 'I4', 'Usina 117'),
    (469, 472, 'I4', 'Usina 118'),
    (473, 476, 'I4', 'Usina 119'),
    (477, 480, 'I4', 'Usina 120'),
    (481, 484, 'I4', 'Usina 121'),
    (485, 488, 'I4', 'Usina 122'),
    (489, 492, 'I4', 'Usina 123'),
    (493, 496, 'I4', 'Usina 124'),
    (497, 500, 'I4', 'Usina 125'),
    (501, 504, 'I4', 'Usina 126'),
    (505, 508, 'I4', 'Usina 127'),
    (509, 512, 'I4', 'Usina 128'),
    (513, 516, 'I4', 'Usina 129'),
    (517, 520, 'I4', 'Usina 130'),
    (521, 524, 'I4', 'Usina 131'),
    (525, 528, 'I4', 'Usina 132'),
    (529, 532, 'I4', 'Usina 133'),
    (533, 536, 'I4', 'Usina 134'),
    (537, 540, 'I4', 'Usina 135'),
    (541, 544, 'I4', 'Usina 136'),
    (545, 548, 'I4', 'Usina 137'),
    (549, 552, 'I4', 'Usina 138'),
    (553, 556, 'I4', 'Usina 139'),
    (557, 560, 'I4', 'Usina 140'),
    (561, 564, 'I4', 'Usina 141'),
    (565, 568, 'I4', 'Usina 142'),
    (569, 572, 'I4', 'Usina 143'),
    (573, 576, 'I4', 'Usina 144'),
    (577, 580, 'I4', 'Usina 145'),
    (581, 584, 'I4', 'Usina 146'),
    (585, 588, 'I4', 'Usina 147'),
    (589, 592, 'I4', 'Usina 148'),
    (593, 596, 'I4', 'Usina 149'),
    (597, 600, 'I4', 'Usina 150'),
    (601, 604, 'I4', 'Usina 151'),
    (605, 608, 'I4', 'Usina 152'),
    (609, 612, 'I4', 'Usina 153'),
    (613, 616, 'I4', 'Usina 154'),
    (617, 620, 'I4', 'Usina 155'),
    (621, 624, 'I4', 'Usina 156'),
    (625, 628, 'I4', 'Usina 157'),
    (629, 632, 'I4', 'Usina 158'),
    (633, 636, 'I4', 'Usina 159'),
    (637, 640, 'I4', 'Usina 160'),
    (641, 644, 'I4', 'Usina 161'),
    (645, 648, 'I4', 'Usina 162'),
    (649, 652, 'I4', 'Usina 163'),
    (653, 656, 'I4', 'Usina 164'),
    (657, 660, 'I4', 'Usina 165'),
    (661, 664, 'I4', 'Usina 166'),
    (665, 668, 'I4', 'Usina 167'),
    (669, 672, 'I4', 'Usina 168'),
    (673, 676, 'I4', 'Usina 169'),
    (677, 680, 'I4', 'Usina 170'),
    (681, 684, 'I4', 'Usina 171'),
    (685, 688, 'I4', 'Usina 172'),
    (689, 692, 'I4', 'Usina 173'),
    (693, 696, 'I4', 'Usina 174'),
    (697, 700, 'I4', 'Usina 175'),
    (701, 704, 'I4', 'Usina 176'),
    (705, 708, 'I4', 'Usina 177'),
    (709, 712, 'I4', 'Usina 178'),
    (713, 716, 'I4', 'Usina 179'),
    (717, 720, 'I4', 'Usina 180'),
    (721, 724, 'I4', 'Usina 181'),
    (725, 728, 'I4', 'Usina 182'),
    (729, 732, 'I4', 'Usina 183'),
    (733, 736, 'I4', 'Usina 184'),
    (737, 740, 'I4', 'Usina 185'),
    (741, 744, 'I4', 'Usina 186'),
    (745, 748, 'I4', 'Usina 187'),
    (749, 752, 'I4', 'Usina 188'),
    (753, 756, 'I4', 'Usina 189'),
    (757, 760, 'I4', 'Usina 190'),
    (761, 764, 'I4', 'Usina 191'),
    (765, 768, 'I4', 'Usina 192'),
    (769, 772, 'I4', 'Usina 193'),
    (773, 776, 'I4', 'Usina 194'),
    (777, 780, 'I4', 'Usina 195'),
    (781, 784, 'I4', 'Usina 196'),
    (785, 788, 'I4', 'Usina 197'),
    (789, 792, 'I4', 'Usina 198'),
    (793, 796, 'I4', 'Usina 199'),
    (797, 800, 'I4', 'Usina 200'),
    (801, 804, 'I4', 'Usina 201'),
    (805, 808, 'I4', 'Usina 202'),
    (809, 812, 'I4', 'Usina 203'),
    (813, 816, 'I4', 'Usina 204'),
    (817, 820, 'I4', 'Usina 205'),
    (821, 824, 'I4', 'Usina 206'),
    (825, 828, 'I4', 'Usina 207'),
    (829, 832, 'I4', 'Usina 208'),
    (833, 836, 'I4', 'Usina 209'),
    (837, 840, 'I4', 'Usina 210'),
    (841, 844, 'I4', 'Usina 211'),
    (845, 848, 'I4', 'Usina 212'),
    (849, 852, 'I4', 'Usina 213'),
    (853, 856, 'I4', 'Usina 214'),
    (857, 860, 'I4', 'Usina 215'),
    (861, 864, 'I4', 'Usina 216'),
    (865, 868, 'I4', 'Usina 217'),
    (869, 872, 'I4', 'Usina 218'),
    (873, 876, 'I4', 'Usina 219'),
    (877, 880, 'I4', 'Usina 220'),
    (881, 884, 'I4', 'Usina 221'),
    (885, 888, 'I4', 'Usina 222'),
    (889, 892, 'I4', 'Usina 223'),
    (893, 896, 'I4', 'Usina 224'),
    (897, 900, 'I4', 'Usina 225'),
    (901, 904, 'I4', 'Usina 226'),
    (905, 908, 'I4', 'Usina 227'),
    (909, 912, 'I4', 'Usina 228'),
    (913, 916, 'I4', 'Usina 229'),
    (917, 920, 'I4', 'Usina 230'),
    (921, 924, 'I4', 'Usina 231'),
    (925, 928, 'I4', 'Usina 232'),
    (929, 932, 'I4', 'Usina 233'),
    (933, 936, 'I4', 'Usina 234'),
    (937, 940, 'I4', 'Usina 235'),
    (941, 944, 'I4', 'Usina 236'),
    (945, 948, 'I4', 'Usina 237'),
    (949, 952, 'I4', 'Usina 238'),
    (953, 956, 'I4', 'Usina 239'),
    (957, 960, 'I4', 'Usina 240'),
    (961, 964, 'I4', 'Usina 241'),
    (965, 968, 'I4', 'Usina 242'),
    (969, 972, 'I4', 'Usina 243'),
    (973, 976, 'I4', 'Usina 244'),
    (977, 980, 'I4', 'Usina 245'),
    (981, 984, 'I4', 'Usina 246'),
    (985, 988, 'I4', 'Usina 247'),
    (989, 992, 'I4', 'Usina 248'),
    (993, 996, 'I4', 'Usina 249'),
    (997, 1000, 'I4', 'Usina 250'),
    (1001, 1004, 'I4', 'Usina 251'),
    (1005, 1008, 'I4', 'Usina 252'),
    (1009, 1012, 'I4', 'Usina 253'),
    (1013, 1016, 'I4', 'Usina 254'),
    (1017, 1020, 'I4', 'Usina 255'),
    (1021, 1024, 'I4', 'Usina 256'),
    (1025, 1028, 'I4', 'Usina 257'),
    (1029, 1032, 'I4', 'Usina 258'),
    (1033, 1036, 'I4', 'Usina 259'),
    (1037, 1040, 'I4', 'Usina 260'),
    (1041, 1044, 'I4', 'Usina 261'),
    (1045, 1048, 'I4', 'Usina 262'),
    (1049, 1052, 'I4', 'Usina 263'),
    (1053, 1056, 'I4', 'Usina 264'),
    (1057, 1060, 'I4', 'Usina 265'),
    (1061, 1064, 'I4', 'Usina 266'),
    (1065, 1068, 'I4', 'Usina 267'),
    (1069, 1072, 'I4', 'Usina 268'),
    (1073, 1076, 'I4', 'Usina 269'),
    (1077, 1080, 'I4', 'Usina 270'),
    (1081, 1084, 'I4', 'Usina 271'),
    (1085, 1088, 'I4', 'Usina 272'),
    (1089, 1092, 'I4', 'Usina 273'),
    (1093, 1096, 'I4', 'Usina 274'),
    (1097, 1100, 'I4', 'Usina 275'),
    (1101, 1104, 'I4', 'Usina 276'),
    (1105, 1108, 'I4', 'Usina 277'),
    (1109, 1112, 'I4', 'Usina 278'),
    (1113, 1116, 'I4', 'Usina 279'),
    (1117, 1120, 'I4', 'Usina 280'),
    (1121, 1124, 'I4', 'Usina 281'),
    (1125, 1128, 'I4', 'Usina 282'),
    (1129, 1132, 'I4', 'Usina 283'),
    (1133, 1136, 'I4', 'Usina 284'),
    (1137, 1140, 'I4', 'Usina 285'),
    (1141, 1144, 'I4', 'Usina 286'),
    (1145, 1148, 'I4', 'Usina 287'),
    (1149, 1152, 'I4', 'Usina 288'),
    (1153, 1156, 'I4', 'Usina 289'),
    (1157, 1160, 'I4', 'Usina 290'),
    (1161, 1164, 'I4', 'Usina 291'),
    (1165, 1168, 'I4', 'Usina 292'),
    (1169, 1172, 'I4', 'Usina 293'),
    (1173, 1176, 'I4', 'Usina 294'),
    (1177, 1180, 'I4', 'Usina 295'),
    (1181, 1184, 'I4', 'Usina 296'),
    (1185, 1188, 'I4', 'Usina 297'),
    (1189, 1192, 'I4', 'Usina 298'),
    (1193, 1196, 'I4', 'Usina 299'),
    (1197, 1200, 'I4', 'Usina 300'),
    (1201, 1204, 'I4', 'Usina 301'),
    (1205, 1208, 'I4', 'Usina 302'),
    (1209, 1212, 'I4', 'Usina 303'),
    (1213, 1216, 'I4', 'Usina 304'),
    (1217, 1220, 'I4', 'Usina 305'),
    (1221, 1224, 'I4', 'Usina 306'),
    (1225, 1228, 'I4', 'Usina 307'),
    (1229, 1232, 'I4', 'Usina 308'),
    (1233, 1236, 'I4', 'Usina 309'),
    (1237, 1240, 'I4', 'Usina 310'),
    (1241, 1244, 'I4', 'Usina 311'),
    (1245, 1248, 'I4', 'Usina 312'),
    (1249, 1252, 'I4', 'Usina 313'),
    (1253, 1256, 'I4', 'Usina 314'),
    (1257, 1260, 'I4', 'Usina 315'),
    (1261, 1264, 'I4', 'Usina 316'),
    (1265, 1268, 'I4', 'Usina 317'),
    (1269, 1272, 'I4', 'Usina 318'),
    (1273, 1276, 'I4', 'Usina 319'),
    (1277, 1280, 'I4', 'Usina 320')]
        self.valores = []

class MLT(UTILS):
    def __init__(self,caminho):
        self.blocos = {'mlt':mlt_block()}
        self.caminho = caminho
        self.mlt = self.blocos['mlt']
        self.nome = "MLT"
        self.ERROS = []
        self.load()
        self.hash = super().gerarHash()


    def load(self):
        if type(self.caminho)==bytes:
            dados = self.caminho
        else:
            with open(self.caminho, 'rb') as f:
                dados = f.read()
        reg_num  = len(dados) // self.mlt.size
        for i in range(reg_num):
            reg_bytes = dados[self.mlt.size * i : self.mlt.size * (i + 1)]
            self.mlt.valores.append(super()._interpretarLinhaBinaria(self.mlt.campos, reg_bytes))

    def save(self):
        return super()._saveToFileBytes(self.blocos.values())
    